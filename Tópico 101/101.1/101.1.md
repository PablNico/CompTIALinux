# 101.1 - Identificar e configurar o Hardware

### BIOS

Toda placa-mãe conta com um `firmware` rodando um sistema chamado **`BIOS`** (Basic Input Output System), geralmente pode ser acessada com as teclas `F2` ou `DEL`no momento da inicialização do sistema.



No momento em que ligamos nosso computador a**`BIOS`**realiza alguns testes antes de ligar definitivamente, por exemplo:



- POST: Power-on Self-Teste. Testa cada dispositivo conectado, caso algum dispositivo não passe nesse teste o SPEAKER da placa-mãe irá fazer alguns BIPS para mostrar onde está o problema.



- Gerencia Dispositivos, IRQ (Interruput Requets), I/O, DMA, etc...
- Inicia o processo de Boot.



Em computadores mais atuais existem outros tipos de BIOS: `EFI` e `UEFI`, que tem o mesmo propósito mas contam com mais opções.



### IRQ 

Para que todos os dispositivos funcionem corretamente, são enviados sinais para CPU para que ela "escute" o dispositivo que enviou esse sinal. Esses sinais são conhecidos como **`IRQ`**(Interruput Request) e os dispositivos não podem ter o mesmo IRQ para evitar conflitos. Os principais sinais são: 

- IRQ 1 - Teclado
- IRQ 2 - Cascateador de IRQs
  - Redireciona para IRQs de 8 até 15
- IRQ 3 - Porta serial VGA (RS-232)
- IRQ 4 - Porta serial VGA (RS-232) 
- IRQ 14 - IDE Primary
- IRQ 15 - IDE Secondary



Para visualizarmos isso no GNU/Linux temos o arquivo /proc/interrupts que mostra quantas vezes foi enviado cada sinal para cada CPU desde que foi ligada. Um processador octa-core irá ter 8 colunas de 0 a 7.



### DMA



DMA (Direct Memory Acess) é um canal que permite que os dispositivos transmitam os dados diretamente para memória, sem utilizar a CPU. Isso gera um ganho de desempenho. Podemos ver que dispositivos estão usando **`DMA`** no arquivo **`/proc/dma`**.



### Endereços I/O

Cada dispositivo conta com um endereço em memória Fixo para comunicação com o CPU. O comando **`$ cat sudo /proc/ioports`** mostra esses endereços.





# Barramentos

São as conexões físicas do computador, através deles adicionamos novos dispositivos à maquina.



### `PCI` (Peripheral Component Interconnect)

São os barramentos localizados diretamente na placa-mãe, geralmente utilizados por placas de vídeo, placas de rede, alguns tipos de HD's e SSD's.

Geralmente são dispositivos **`coldplug`**.

Podemos verificar quais dispositivos estão conectados no barramento PCI com o comando **`lspci`**.

Para obtermos mais detalhes sobre determinado dispositivo usamos a sintáxe **`lspci -s xx:xx.x -v`**, onde devemos substituir, após o parâmetro **`-s`** pelo número do dispositivo desejado.



```bash
$ sudo lspci -s 00:1d.0 -v
00:1d.0 USB controller: Intel Corporation Wildcat Point-LP USB EHCI Controller (rev 03) (prog-if 20 [EHCI])
	Subsystem: Dell Wildcat Point-LP USB EHCI Controller
	Flags: bus master, medium devsel, latency 0, IRQ 23
	Memory at c3319000 (32-bit, non-prefetchable) [size=1K]
	Capabilities: [50] Power Management version 3
	Capabilities: [58] Debug port: BAR=1 offset=00a0
	Capabilities: [98] PCI Advanced Features
	Kernel driver in use: ehci-pci
```





### `USB` (Universal Serial Bus)

Utilizado por mouses, teclados, pendrives e diversos outros dispositivos para estabelecer uma conexão com a máquina.

Geralmente são dispositivos **`hotplug`**.

Podemos verificar quais dispositivos estão conectados no barramento PCI com o comando **`lsusb`**. Para identificar o código de cada dispositivos e procurar mais detalhes pegamos o número do barramento que está conectado e o dispositivo nesse barramento.

```bash
$ lsusb
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 003 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub

# Para pegar mais detalhes sobre cada dispositivo
# USB 2.0
$ lsusb -s 001:001 -v
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 Full speed (or root) hub
  bMaxPacketSize0        64
...

#USB 3.0
$ lsusb -s 003:001 -v
bLength                18
  bDescriptorType         1
  bcdUSB               3.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         3 
  bMaxPacketSize0         9

...
```

