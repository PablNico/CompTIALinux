# 102.2 - Instalação e configuração de Bootmanager

Como vimos anteriormente, após a **`BIOS`** identificar o disco e encontrar a **`MBR`**, fica a cargo do **`GRUB`** selecionar o Kernel e iniciar o **`init`**, este que executa determinado **`runlevel`** com seus serviços.

Existem duas versões do **`GRUB	`**, que além de contar com novos arquivos de configuração, contém uma sintáxe e comandos diferentes, além de mais maneiras de referênciar os discos. São eles **`GRUB Legacy`** (mais antigo) e **`GRUB2 `** (Atualização).

Nesse subtópico veremos como instalar e configurar as duas versões do **`GRUB`**.



# Grub legacy

Seu arquivo de configuração principal fica em **`/boot/grub/menu.lst`**.



##### Referencia ao disco

O primeiro HD é referenciado como hd0 e sua partição também começa com 0. 

​	Ex:

​		 sda1 = hd0,0

​		 sdb1 = hd1,0

​		 sda5 = hd0,4



##### Comandos

Para instalar o **`GRUB`** em determinada partição usamos o comando:

```bash
$ grub-install /dev/sda
# ou
$ grub-install '(hd0)'
```

O Grub é instalado nos primeiros 512Bytes do disco, dedicados ao MBR. Caso seja feita alguma alteração em seu arquivo de configuração, não é necessário reinstalar o grub.



##### Principais parâmetos

Dentro do grub temos parâmetros globais de configuração do mesmo e parâmetros de cada boot.

- **title**: Nome que aparecerá na lista de seleção do grub.
- **root (hd0,0)** : Local onde está o diretório raiz do **SO**, caso a partição **`/boot`** esteja montada fora do **`/`** deve-se indicar ela.
- **kernel**: Local onde está o Kernel desejado, além disso podemos passar alguns parâmetros.
- **initrd**: Local onde está o initd desejado.
- **default**: Número do boot padrão, geralmente tem o valor 0.
- **timeout**: Tempo em segundos que o Grub deve esperar para selecionar o boot **default**.



# Grub2

Seu arquivo de configuração principal fica em **`/boot/grub/grub.cfg`** que é gerado apartir das edições do administrador dos arquivos **`/etc/default/grub`**e**`/etc/grub.d`**. 



###### Referência ao disco

O primeiro HD é referenciado como hd0 e sua partição também começa com 1. 

​	Ex:

- sda1 = hd0,1
- sdb1 = hd1,1
- sda5 = hd0,5



Podemos também deixar explicito o tipo da partição, por exemplo:



- sda1 = hd0,msdos1 
- sdb1 = hd1,1
- sda5 = hd0,gpt5



Devemos saber que **`msdos`** e **`gpt`** referenciam-se à partições **`MBR`** e **`GPT`** respectivamente.



###### Comandos

- `grub-install <device>`;
- `update-grub`: Lê alterações nos arquivos **`/etc/default/grub`** e **`/etc/grub.d/`** e atualiza a configuração principal;
- `grub-mkconfig -o`*arquivo*: Lê alterações nos arquivos **`/etc/default/grub`** e **`/etc/grub.d/`** e gera um arquivo de configuração no diretório que for definido.







###### Principais parâmetros

- **menuentry "Ubuntu"** : Nome que aparecerá na lista de seleção do grub.
  - Toda configuração a seguir deve estar dentro de chaves "**{}**". Ela deve ser aberta depois da definição de nome e fechada após a definição de **`initrd`**.
- **set root=(hd0,1)**: Local onde está o diretório raiz do **SO**, caso a partição **`/boot`** esteja montada fora do **`/`** deve-se indicar ela.
- **linux**: Local onde está o Kernel desejado, além disso podemos passar alguns parâmetros.
- **initrd**: Local onde está o initd desejado.
- **GRUB_DEFAULT=**: Número do boot padrão, geralmente tem o valor 0.
- **GRUB_TIMEOUT=**: Tempo em segundos que o Grub deve esperar para selecionar o boot **default**.

